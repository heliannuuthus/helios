basePath: /api
definitions:
  handlers.BannerItem:
    properties:
      id:
        type: string
      image_url:
        type: string
      link:
        type: string
      link_type:
        type: string
      title:
        type: string
    type: object
  handlers.BatchCheckRequest:
    properties:
      recipe_ids:
        items:
          type: string
        type: array
    required:
    - recipe_ids
    type: object
  handlers.BatchCheckResponse:
    properties:
      favorited_ids:
        items:
          type: string
        type: array
    type: object
  handlers.CategoryResponse:
    properties:
      key:
        type: string
      label:
        type: string
    type: object
  handlers.CheckFavoriteResponse:
    properties:
      is_favorite:
        type: boolean
    type: object
  handlers.ContextRequest:
    properties:
      latitude:
        type: number
      longitude:
        type: number
      timestamp:
        type: integer
    required:
    - latitude
    - longitude
    type: object
  handlers.ContextResponse:
    properties:
      location:
        $ref: '#/definitions/handlers.LocationInfo'
      time:
        $ref: '#/definitions/handlers.TimeInfo'
      weather:
        $ref: '#/definitions/handlers.WeatherInfo'
    type: object
  handlers.CreateTagRequest:
    properties:
      label:
        description: 显示名称
        type: string
      recipe_id:
        description: 菜谱ID（可选，为空时创建选项）
        type: string
      type:
        description: 标签类型
        type: string
      value:
        description: 标签值
        type: string
    required:
    - label
    - type
    - value
    type: object
  handlers.FavoriteListItem:
    properties:
      created_at:
        type: string
      recipe:
        $ref: '#/definitions/handlers.RecipeListItem'
      recipe_id:
        type: string
    type: object
  handlers.FavoriteListResponse:
    properties:
      items:
        items:
          $ref: '#/definitions/handlers.FavoriteListItem'
        type: array
      total:
        type: integer
    type: object
  handlers.FavoriteRequest:
    properties:
      recipe_id:
        type: string
    required:
    - recipe_id
    type: object
  handlers.FavoriteResponse:
    properties:
      created_at:
        type: string
      recipe_id:
        type: string
    type: object
  handlers.HistoryListItem:
    properties:
      recipe:
        $ref: '#/definitions/handlers.RecipeListItem'
      recipe_id:
        type: string
      viewed_at:
        type: string
    type: object
  handlers.HistoryListResponse:
    properties:
      items:
        items:
          $ref: '#/definitions/handlers.HistoryListItem'
        type: array
      total:
        type: integer
    type: object
  handlers.HistoryRequest:
    properties:
      recipe_id:
        type: string
    required:
    - recipe_id
    type: object
  handlers.HistoryResponse:
    properties:
      recipe_id:
        type: string
      viewed_at:
        type: string
    type: object
  handlers.IngredientRequest:
    properties:
      name:
        type: string
      notes:
        type: string
      quantity:
        type: number
      text_quantity:
        type: string
      unit:
        type: string
    required:
    - name
    - text_quantity
    type: object
  handlers.IngredientResponse:
    properties:
      category:
        type: string
      id:
        type: integer
      name:
        type: string
      notes:
        type: string
      quantity:
        type: number
      text_quantity:
        type: string
      unit:
        type: string
    type: object
  handlers.LocationInfo:
    properties:
      city:
        type: string
      district:
        type: string
      province:
        type: string
    type: object
  handlers.OAuth2Error:
    properties:
      error:
        type: string
      error_description:
        type: string
    type: object
  handlers.RecipeCreateRequest:
    properties:
      additional_notes:
        items:
          type: string
        type: array
      category:
        type: string
      cook_time_minutes:
        type: integer
      description:
        type: string
      difficulty:
        type: integer
      id:
        type: string
      images:
        items:
          type: string
        type: array
      ingredients:
        items:
          $ref: '#/definitions/handlers.IngredientRequest'
        type: array
      name:
        type: string
      prep_time_minutes:
        type: integer
      servings:
        type: integer
      steps:
        items:
          $ref: '#/definitions/handlers.StepRequest'
        type: array
      tags:
        items:
          type: string
        type: array
      total_time_minutes:
        type: integer
    required:
    - category
    - difficulty
    - name
    - servings
    type: object
  handlers.RecipeListItem:
    properties:
      category:
        type: string
      description:
        type: string
      difficulty:
        type: integer
      id:
        type: string
      image_path:
        type: string
      name:
        type: string
      tags:
        $ref: '#/definitions/handlers.TagsGrouped'
      total_time_minutes:
        type: integer
    type: object
  handlers.RecipeResponse:
    properties:
      additional_notes:
        items:
          type: string
        type: array
      category:
        type: string
      cook_time_minutes:
        type: integer
      description:
        type: string
      difficulty:
        type: integer
      id:
        type: string
      image_path:
        type: string
      images:
        items:
          type: string
        type: array
      ingredients:
        items:
          $ref: '#/definitions/handlers.IngredientResponse'
        type: array
      name:
        type: string
      prep_time_minutes:
        type: integer
      servings:
        type: integer
      steps:
        items:
          $ref: '#/definitions/handlers.StepResponse'
        type: array
      tags:
        $ref: '#/definitions/handlers.TagsGrouped'
      total_time_minutes:
        type: integer
    type: object
  handlers.RecipeUpdateRequest:
    properties:
      additional_notes:
        items:
          type: string
        type: array
      category:
        type: string
      cook_time_minutes:
        type: integer
      description:
        type: string
      difficulty:
        type: integer
      images:
        items:
          type: string
        type: array
      ingredients:
        items:
          $ref: '#/definitions/handlers.IngredientRequest'
        type: array
      name:
        type: string
      prep_time_minutes:
        type: integer
      servings:
        type: integer
      steps:
        items:
          $ref: '#/definitions/handlers.StepRequest'
        type: array
      tags:
        items:
          type: string
        type: array
      total_time_minutes:
        type: integer
    type: object
  handlers.RecommendRecipeItem:
    properties:
      category:
        type: string
      description:
        type: string
      difficulty:
        type: integer
      id:
        type: string
      image_path:
        type: string
      name:
        type: string
      reason:
        description: 该菜品的推荐理由
        type: string
      tags:
        $ref: '#/definitions/handlers.TagsGrouped'
      total_time_minutes:
        type: integer
    type: object
  handlers.RecommendRequest:
    properties:
      exclude_ids:
        description: 排除的菜谱 ID（换一批时传入已推荐的）
        items:
          type: string
        type: array
      latitude:
        type: number
      longitude:
        type: number
      timestamp:
        type: integer
    required:
    - latitude
    - longitude
    type: object
  handlers.RecommendResponse:
    properties:
      recipes:
        items:
          $ref: '#/definitions/handlers.RecommendRecipeItem'
        type: array
      remaining:
        description: 今日剩余推荐次数
        type: integer
      summary:
        description: LLM 生成的一句话整体评价
        type: string
    type: object
  handlers.StatsResponse:
    properties:
      favorites:
        description: 收藏数
        type: integer
      history:
        description: 浏览历史数
        type: integer
    type: object
  handlers.StepRequest:
    properties:
      description:
        type: string
      step:
        type: integer
    required:
    - description
    - step
    type: object
  handlers.StepResponse:
    properties:
      description:
        type: string
      id:
        type: integer
      step:
        type: integer
    type: object
  handlers.TagValueResponse:
    properties:
      label:
        type: string
      value:
        type: string
    type: object
  handlers.TagsGrouped:
    properties:
      cuisines:
        items:
          type: string
        type: array
      flavors:
        items:
          type: string
        type: array
      scenes:
        items:
          type: string
        type: array
    type: object
  handlers.TimeInfo:
    properties:
      day_of_week:
        type: integer
      hour:
        type: integer
      meal_time:
        type: string
      season:
        type: string
      timestamp:
        type: integer
    type: object
  handlers.TokenResponse:
    properties:
      access_token:
        type: string
      expires_in:
        type: integer
      refresh_token:
        type: string
      token_type:
        type: string
    type: object
  handlers.UpdateProfileRequest:
    properties:
      avatar:
        description: 移除 url 验证，允许临时路径或 OSS URL
        maxLength: 512
        type: string
      gender:
        enum:
        - 0
        - 1
        - 2
        type: integer
      nickname:
        maxLength: 64
        type: string
      phone_code:
        description: 小程序授权码，用于绑定手机号；传空字符串表示解绑，不传则不处理
        type: string
    type: object
  handlers.UpdateTagRequest:
    properties:
      label:
        type: string
    required:
    - label
    type: object
  handlers.UploadImageResponse:
    properties:
      url:
        description: 上传后的图片 URL
        type: string
    type: object
  handlers.UserProfile:
    properties:
      avatar:
        type: string
      gender:
        type: integer
      nickname:
        type: string
      openid:
        type: string
      phone:
        type: string
    type: object
  handlers.WeatherInfo:
    properties:
      humidity:
        type: integer
      icon:
        type: string
      temperature:
        type: number
      weather:
        type: string
    type: object
  preference.OptionItem:
    properties:
      label:
        description: 显示名称
        type: string
      value:
        description: 标签值
        type: string
    type: object
  preference.OptionItemWithSelected:
    properties:
      label:
        description: 显示名称
        type: string
      selected:
        description: 是否已选择
        type: boolean
      value:
        description: 标签值
        type: string
    type: object
  preference.OptionsResponse:
    properties:
      allergies:
        description: 过敏选项
        items:
          $ref: '#/definitions/preference.OptionItem'
        type: array
      flavors:
        description: 口味选项
        items:
          $ref: '#/definitions/preference.OptionItem'
        type: array
      taboos:
        description: 忌口选项
        items:
          $ref: '#/definitions/preference.OptionItem'
        type: array
    type: object
  preference.UpdatePreferencesRequest:
    properties:
      allergies:
        description: 过敏选项值列表
        items:
          type: string
        type: array
      flavors:
        description: 口味选项值列表
        items:
          type: string
        type: array
      taboos:
        description: 忌口选项值列表
        items:
          type: string
        type: array
    type: object
  preference.UserPreferencesResponse:
    properties:
      allergies:
        description: 过敏偏好
        items:
          $ref: '#/definitions/preference.OptionItemWithSelected'
        type: array
      flavors:
        description: 口味偏好
        items:
          $ref: '#/definitions/preference.OptionItemWithSelected'
        type: array
      taboos:
        description: 忌口偏好
        items:
          $ref: '#/definitions/preference.OptionItemWithSelected'
        type: array
    type: object
host: localhost:18000
info:
  contact: {}
  description: 菜谱管理系统后端 API
  title: Choosy API
  version: "1.0"
paths:
  /api/context:
    post:
      consumes:
      - application/json
      description: 根据经纬度获取位置、天气、时间信息
      parameters:
      - description: 上下文请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handlers.ContextRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handlers.ContextResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: 获取推荐上下文
      tags:
      - context
  /api/home/banners:
    get:
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/handlers.BannerItem'
            type: array
      summary: 获取首页 Banner
      tags:
      - home
  /api/home/hot:
    get:
      parameters:
      - default: 6
        description: 数量限制
        in: query
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/handlers.RecipeListItem'
            type: array
      summary: 获取热门菜谱（按收藏数排序）
      tags:
      - home
  /api/home/recommend:
    get:
      parameters:
      - default: 4
        description: 数量限制
        in: query
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/handlers.RecipeListItem'
            type: array
      summary: 获取推荐菜谱（随机）
      tags:
      - home
  /api/preferences:
    get:
      description: 获取口味、忌口、过敏的所有可选选项（从缓存索引获取，性能最优）
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/preference.OptionsResponse'
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      summary: 获取所有偏好选项
      tags:
      - preference
  /api/recipes:
    get:
      parameters:
      - description: 分类
        in: query
        name: category
        type: string
      - description: 搜索关键词
        in: query
        name: search
        type: string
      - default: 100
        description: 限制数量
        in: query
        name: limit
        type: integer
      - default: 0
        description: 偏移量
        in: query
        name: offset
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/handlers.RecipeListItem'
            type: array
      summary: 获取菜谱列表
      tags:
      - recipes
    post:
      consumes:
      - application/json
      parameters:
      - description: 菜谱信息
        in: body
        name: recipe
        required: true
        schema:
          $ref: '#/definitions/handlers.RecipeCreateRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/handlers.RecipeResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
      summary: 创建新菜谱
      tags:
      - recipes
  /api/recipes/{recipe_id}:
    delete:
      parameters:
      - description: 菜谱ID
        in: path
        name: recipe_id
        required: true
        type: string
      responses:
        "204":
          description: No Content
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      summary: 删除菜谱
      tags:
      - recipes
    get:
      parameters:
      - description: 菜谱ID
        in: path
        name: recipe_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handlers.RecipeResponse'
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      summary: 获取菜谱详情
      tags:
      - recipes
    put:
      consumes:
      - application/json
      parameters:
      - description: 菜谱ID
        in: path
        name: recipe_id
        required: true
        type: string
      - description: 更新内容
        in: body
        name: recipe
        required: true
        schema:
          $ref: '#/definitions/handlers.RecipeUpdateRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handlers.RecipeResponse'
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      summary: 更新菜谱
      tags:
      - recipes
  /api/recipes/batch:
    post:
      consumes:
      - application/json
      parameters:
      - description: 菜谱列表
        in: body
        name: recipes
        required: true
        schema:
          items:
            $ref: '#/definitions/handlers.RecipeCreateRequest'
          type: array
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            items:
              $ref: '#/definitions/handlers.RecipeResponse'
            type: array
      summary: 批量创建菜谱
      tags:
      - recipes
  /api/recipes/categories/list:
    get:
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/handlers.CategoryResponse'
            type: array
      summary: 获取所有分类
      tags:
      - recipes
  /api/recommend:
    post:
      consumes:
      - application/json
      description: 根据地理位置、天气、时间等因素智能推荐菜谱（基于 LLM，支持用户个性化）
      parameters:
      - description: 推荐请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handlers.RecommendRequest'
      - default: 6
        description: 返回数量
        in: query
        name: limit
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handlers.RecommendResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
      summary: 获取智能推荐菜谱
      tags:
      - recommend
  /api/revoke:
    post:
      consumes:
      - application/x-www-form-urlencoded
      parameters:
      - description: 要撤销的 refresh_token
        in: formData
        name: token
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handlers.OAuth2Error'
      summary: 撤销 token
      tags:
      - auth
  /api/revoke-all:
    post:
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - Bearer: []
      summary: 登出所有设备
      tags:
      - auth
  /api/stats:
    get:
      consumes:
      - application/json
      description: 获取当前用户的收藏数和浏览历史数
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handlers.StatsResponse'
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - Bearer: []
      summary: 获取用户统计数据
      tags:
      - auth
  /api/tags:
    get:
      description: 获取标签列表，支持通过查询参数过滤。所有类型（cuisine/flavor/scene/taboo/allergy）都统一使用此接口
      parameters:
      - description: '标签类型: cuisine/flavor/scene/taboo/allergy'
        in: query
        name: type
        type: string
      - description: 菜谱ID（获取特定菜谱的标签，仅用于 cuisine/flavor/scene）
        in: query
        name: recipe_id
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/handlers.TagValueResponse'
            type: array
      summary: 获取标签列表
      tags:
      - tags
    post:
      consumes:
      - application/json
      description: 创建标签或选项。如果 recipe_id 为空，创建选项（仅支持 taboo/allergy）；如果 recipe_id 不为空，创建菜谱标签
      parameters:
      - description: 标签信息
        in: body
        name: tag
        required: true
        schema:
          $ref: '#/definitions/handlers.CreateTagRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/handlers.TagValueResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
      summary: 创建标签
      tags:
      - tags
  /api/tags/{type}:
    get:
      description: 支持所有类型：cuisine/flavor/scene/taboo/allergy
      parameters:
      - description: '标签类型: cuisine/flavor/scene/taboo/allergy'
        in: path
        name: type
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/handlers.TagValueResponse'
            type: array
      summary: 根据类型获取标签
      tags:
      - tags
  /api/tags/{type}/{value}:
    delete:
      description: 删除标签或选项
      parameters:
      - description: 标签类型
        in: path
        name: type
        required: true
        type: string
      - description: 标签值
        in: path
        name: value
        required: true
        type: string
      - description: 菜谱ID（删除菜谱标签时必填，删除选项时留空）
        in: query
        name: recipe_id
        type: string
      responses:
        "204":
          description: No Content
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
      summary: 删除标签
      tags:
      - tags
    put:
      consumes:
      - application/json
      description: 更新标签或选项的显示名称
      parameters:
      - description: 标签类型
        in: path
        name: type
        required: true
        type: string
      - description: 标签值
        in: path
        name: value
        required: true
        type: string
      - description: 菜谱ID（更新菜谱标签时必填，更新选项时留空）
        in: query
        name: recipe_id
        type: string
      - description: 更新内容
        in: body
        name: tag
        required: true
        schema:
          $ref: '#/definitions/handlers.UpdateTagRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handlers.TagValueResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
      summary: 更新标签
      tags:
      - tags
  /api/tags/cuisines:
    get:
      deprecated: true
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/handlers.TagValueResponse'
            type: array
      summary: 获取所有菜系
      tags:
      - tags
  /api/tags/flavors:
    get:
      deprecated: true
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/handlers.TagValueResponse'
            type: array
      summary: 获取所有口味
      tags:
      - tags
  /api/tags/scenes:
    get:
      deprecated: true
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/handlers.TagValueResponse'
            type: array
      summary: 获取所有场景
      tags:
      - tags
  /api/token:
    post:
      consumes:
      - application/x-www-form-urlencoded
      description: 支持 authorization_code（微信登录）和 refresh_token 两种 grant_type
      parameters:
      - description: 授权类型
        enum:
        - authorization_code
        - refresh_token
        in: formData
        name: grant_type
        required: true
        type: string
      - description: 微信登录 code（grant_type=authorization_code 时必填）
        in: formData
        name: code
        type: string
      - description: 刷新令牌（grant_type=refresh_token 时必填）
        in: formData
        name: refresh_token
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handlers.TokenResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/handlers.OAuth2Error'
        "412":
          description: refresh_token 无效或已过期
          schema:
            $ref: '#/definitions/handlers.OAuth2Error'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/handlers.OAuth2Error'
      summary: 获取/刷新 token
      tags:
      - auth
  /api/upload/image:
    post:
      consumes:
      - multipart/form-data
      parameters:
      - description: 完整的 OSS 对象键，如 avatars/user123.jpg（优先级高于 prefix）
        in: formData
        name: object-key
        type: string
      - description: 文件路径前缀，如 avatars, images（当 object-key 为空时使用）
        in: formData
        name: prefix
        type: string
      - description: 图片文件
        in: formData
        name: file
        required: true
        type: file
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handlers.UploadImageResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - Bearer: []
      summary: 上传图片到 OSS
      tags:
      - upload
  /api/user/favorites:
    get:
      parameters:
      - description: 分类筛选
        in: query
        name: category
        type: string
      - description: 搜索关键词
        in: query
        name: search
        type: string
      - default: 20
        description: 限制数量
        in: query
        name: limit
        type: integer
      - default: 0
        description: 偏移量
        in: query
        name: offset
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handlers.FavoriteListResponse'
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
      summary: 获取收藏列表
      tags:
      - favorites
    post:
      consumes:
      - application/json
      parameters:
      - description: 收藏信息
        in: body
        name: favorite
        required: true
        schema:
          $ref: '#/definitions/handlers.FavoriteRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/handlers.FavoriteResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
      summary: 添加收藏
      tags:
      - favorites
  /api/user/favorites/{recipe_id}:
    delete:
      parameters:
      - description: 菜谱ID
        in: path
        name: recipe_id
        required: true
        type: string
      responses:
        "204":
          description: No Content
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
      summary: 取消收藏
      tags:
      - favorites
  /api/user/favorites/{recipe_id}/check:
    get:
      parameters:
      - description: 菜谱ID
        in: path
        name: recipe_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handlers.CheckFavoriteResponse'
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
      summary: 检查是否已收藏
      tags:
      - favorites
  /api/user/favorites/batch-check:
    post:
      consumes:
      - application/json
      parameters:
      - description: 菜谱ID列表
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handlers.BatchCheckRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handlers.BatchCheckResponse'
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
      summary: 批量检查收藏状态
      tags:
      - favorites
  /api/user/history:
    delete:
      responses:
        "204":
          description: No Content
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
      summary: 清空浏览历史
      tags:
      - history
    get:
      parameters:
      - description: 分类筛选
        in: query
        name: category
        type: string
      - description: 搜索关键词
        in: query
        name: search
        type: string
      - default: 20
        description: 限制数量
        in: query
        name: limit
        type: integer
      - default: 0
        description: 偏移量
        in: query
        name: offset
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handlers.HistoryListResponse'
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
      summary: 获取浏览历史列表
      tags:
      - history
    post:
      consumes:
      - application/json
      parameters:
      - description: 浏览记录信息
        in: body
        name: history
        required: true
        schema:
          $ref: '#/definitions/handlers.HistoryRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/handlers.HistoryResponse'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
      summary: 添加浏览记录
      tags:
      - history
  /api/user/history/{recipe_id}:
    delete:
      parameters:
      - description: 菜谱ID
        in: path
        name: recipe_id
        required: true
        type: string
      responses:
        "204":
          description: No Content
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
      summary: 删除浏览记录
      tags:
      - history
  /api/user/preference:
    get:
      description: 获取当前用户的偏好设置（包含选中状态）
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/preference.UserPreferencesResponse'
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: 获取用户偏好
      tags:
      - preference
    put:
      consumes:
      - application/json
      description: 更新当前用户的偏好设置（全量替换）
      parameters:
      - description: 偏好设置
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/preference.UpdatePreferencesRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            additionalProperties:
              type: string
            type: object
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "500":
          description: Internal Server Error
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - BearerAuth: []
      summary: 更新用户偏好
      tags:
      - preference
  /api/user/profile:
    get:
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handlers.UserProfile'
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - Bearer: []
      summary: 获取当前用户信息
      tags:
      - auth
    put:
      consumes:
      - application/json
      parameters:
      - description: 更新请求
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/handlers.UpdateProfileRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/handlers.UserProfile'
        "400":
          description: Bad Request
          schema:
            additionalProperties:
              type: string
            type: object
        "401":
          description: Unauthorized
          schema:
            additionalProperties:
              type: string
            type: object
        "404":
          description: Not Found
          schema:
            additionalProperties:
              type: string
            type: object
      security:
      - Bearer: []
      summary: 更新当前用户信息
      tags:
      - auth
securityDefinitions:
  Bearer:
    description: 输入 "Bearer {token}"
    in: header
    name: Authorization
    type: apiKey
swagger: "2.0"
